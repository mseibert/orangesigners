---
import { Image } from 'astro:assets';
import type { CollectionEntry } from 'astro:content';
import BaseHead from '../components/BaseHead.astro';
import Footer from '../components/Footer.astro';
import FormattedDate from '../components/FormattedDate.astro';
import Header from '../components/Header.astro';
import '../styles/global.css';

type Props = CollectionEntry<'blog'>['data'];

const { title, description, pubDate, updatedDate, heroImage } = Astro.props;

// Extract slug from URL path
const slug = Astro.url.pathname.split('/').pop()?.replace(/\/$/, '') || '';
const ogImageURL = new URL(`/api/og-image?type=blog&slug=${slug}`, Astro.site).href;
---

<html lang="de">
	<head>
		<BaseHead title={title} description={description} ogImage={ogImageURL} />
	</head>

	<body class="bg-gray-50 min-h-screen">
		<Header />
		<main class="max-w-4xl mx-auto px-4 py-8">
			<article class="bg-white rounded-xl shadow-lg overflow-hidden">
				{heroImage && (
					<div class="w-full">
						<Image 
							width={1020} 
							height={510} 
							src={heroImage} 
							alt="" 
							class="w-full h-auto object-cover"
						/>
					</div>
				)}
				
				<div class="p-8 md:p-12">
					<div class="text-center mb-12">
						<div class="mb-6">
							<FormattedDate date={pubDate} class="text-lg text-oranienschule-600 font-medium" />
							{
								updatedDate && (
									<div class="text-sm text-gray-500 italic mt-2">
										Zuletzt aktualisiert am <FormattedDate date={updatedDate} />
									</div>
								)
							}
						</div>
						
						<h1 class="text-4xl md:text-5xl font-bold text-gray-900 mb-6 leading-tight">
							{title}
						</h1>
						
						<div class="w-24 h-1 bg-gradient-to-r from-oranienschule-500 to-oranienschule-600 mx-auto rounded-full"></div>
					</div>
					
					<div class="prose prose-lg max-w-none prose-headings:text-gray-900 prose-headings:font-bold prose-p:text-gray-700 prose-p:leading-relaxed prose-a:text-oranienschule-600 prose-a:font-medium hover:prose-a:text-oranienschule-700 prose-strong:text-gray-900 prose-strong:font-semibold prose-blockquote:border-l-oranienschule-500 prose-blockquote:bg-orange-50 prose-blockquote:py-2 prose-blockquote:px-4 prose-blockquote:rounded-r-lg">
						<slot />
					</div>
				</div>
			</article>
		</main>
		<Footer />
	</body>
</html>
